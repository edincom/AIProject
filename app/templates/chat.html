<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyBot AI - Assistant Intelligent</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
</head>

<body>
    <div class="bg-animation">
        <div class="particle" style="width: 100px; height: 100px; top: 10%; left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="width: 150px; height: 150px; top: 60%; left: 80%; animation-delay: 2s;"></div>
        <div class="particle" style="width: 80px; height: 80px; top: 80%; left: 20%; animation-delay: 4s;"></div>
        <div class="particle" style="width: 120px; height: 120px; top: 30%; left: 70%; animation-delay: 6s;"></div>
    </div>

    <nav class="navbar">
        <div class="logo">StudyBot AI</div>
        <div class="user-info">
            <span>Bienvenue, <strong id="username-display">{{ username }}</strong></span>
            <a href="{{ url_for('login') }}" class="btn-logout">DÃ©connexion</a>
        </div>
    </nav>

    <div class="container">
        <div class="sidebar">
            <h3>ğŸ“š Historique par chapitre</h3>
            <div id="chapterList"></div>
        </div>

        <div class="main-content">
            <div class="mode-selector">
                <label>Mode d'apprentissage :</label>
                <div class="mode-toggle">
                    <button class="mode-option active" data-mode="teach">ğŸ“š Enseigner</button>
                    <button class="mode-option" data-mode="test">âœ… Tester</button>
                </div>
                <button class="btn-clear-chat" id="clearChatBtn">ğŸ—‘ï¸ Effacer la conversation</button>
            </div>

            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="welcome-message">
                        <h2>ğŸ‘‹ Bonjour <span id="welcome-username">{{ username }}</span> !</h2>
                        <p id="welcome-text">Je suis votre assistant d'apprentissage IA. Posez-moi des questions et je
                            serai ravi de vous aider !</p>
                    </div>
                </div>

                <div class="chat-input">
                    <div class="input-wrapper">
                        <textarea id="user-input" placeholder="Posez votre question..." rows="1"></textarea>
                    </div>
                    <button class="btn-send" id="sendBtn">Envoyer</button>
                </div>
            </div>
        </div>

        <div style="margin-top: 2rem; text-align: center;">
            <button onclick="loadHistory()"
                style="padding: 0.8rem 2rem; background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 25px; color: white; cursor: pointer; font-weight: 600; font-size: 1rem; transition: all 0.3s;">
                ğŸ“œ Voir mon historique
            </button>
        </div>

        <div id="historyModal"
            style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:1000; overflow-y:auto;">
            <div style="position:relative; max-width:900px; margin:2rem auto; padding:2rem;">
                <button onclick="closeHistory()"
                    style="position:absolute; top:1rem; right:1rem; background:white; border:none; border-radius:50%; width:40px; height:40px; cursor:pointer; font-size:1.5rem; box-shadow:0 2px 10px rgba(0,0,0,0.2);">Ã—</button>
                <div id="history"></div>
            </div>
        </div>

        <div id="history" style="margin-top:20px; color:white;"></div>

    </div>

    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
</body>

</html>